USING OOL.*.
CLASS OOL.WINBUTTON INHERITS OOL.WINOBJ:
    DEFINE PUBLIC PROPERTY LABEL AS CHARACTER GET.
    PUBLIC SET (cip_label AS CHARACTER):
        ASSIGN THIS-OBJECT:LABEL = cip_label.

        IF THIS-OBJECT:LIVE THEN
        DO:
            ASSIGN THIS-OBJECT:HANDLE:LABEL = THIS-OBJECT:LABEL.
        END.
    END SET.
    
    DEFINE PUBLIC OVERRIDE PROPERTY WIDTH AS INTEGER GET.
    PUBLIC SET (iip_width AS INTEGER):
        ASSIGN THIS-OBJECT:WIDTH = iip_width.

        IF THIS-OBJECT:LIVE THEN
        DO:
        END.
    END SET.

    DEFINE PUBLIC OVERRIDE EVENT FOCUS-OFF SIGNATURE VOID (aip_data AS ARRAY).
    
    DEFINE PRIVATE VARIABLE a_tempData AS ARRAY.

    CONSTRUCTOR WINBUTTON ():
    END CONSTRUCTOR.

    DESTRUCTOR WINBUTTON ():
    END DESTRUCTOR.

    METHOD PUBLIC OVERRIDE VOID ENABLE ():
        IF NOT THIS-OBJECT:LIVE THEN RETURN.

        IF NOT THIS-OBJECT:VISIBLE THEN
        DO:
            ASSIGN THIS-OBJECT:HANDLE:VISIBLE = TRUE.
        END.

        IF NOT THIS-OBJECT:SENSITIVE THEN
            ASSIGN THIS-OBJECT:HANDLE:SENSITIVE = TRUE.

        PUT CURSOR OFF.
        THIS-OBJECT:WAIT().

        a_tempData = NEW ARRAY().
        a_tempData:PUSH-BACK(THIS-OBJECT:LAST-KEY).
        THIS-OBJECT:FOCUS-OFF:PUBLISH(a_tempData).

        IF NOT THIS-OBJECT:SENSITIVE THEN
            ASSIGN THIS-OBJECT:HANDLE:SENSITIVE = FALSE.

        IF NOT THIS-OBJECT:VISIBLE THEN
        DO:
            ASSIGN THIS-OBJECT:HANDLE:VISIBLE = FALSE.
        END.
    END METHOD.

    METHOD PUBLIC OVERRIDE VOID WAIT ():
        /* THIS-OBJECT:HANDLE causes an issue here for some reason */
        WAIT-FOR "GO","PF1","F1","TAB","ENTER","RETURN" OF HANDLE FOCUS HANDLE.
        ASSIGN THIS-OBJECT:LAST-KEY = IF LASTKEY = 32 THEN "SPACEBAR" ELSE KEYLABEL(LASTKEY).
    END METHOD.

    METHOD PUBLIC OVERRIDE LOGICAL REGISTER ():
        IF THIS-OBJECT:LIVE THEN
        DO:

        END.

        CREATE BUTTON THIS-OBJECT:HANDLE ASSIGN
            FRAME        = THIS-OBJECT:PARENT:HANDLE
            LABEL        = THIS-OBJECT:LABEL
            WIDTH-CHARS  = THIS-OBJECT:WIDTH
            HEIGHT-CHARS = THIS-OBJECT:HEIGHT
            COL          = THIS-OBJECT:X
            ROW          = THIS-OBJECT:Y
            SENSITIVE    = THIS-OBJECT:SENSITIVE
            DCOLOR       = THIS-OBJECT:COLOR
            VISIBLE      = THIS-OBJECT:VISIBLE
            NAME         = THIS-OBJECT:NAME.
            
        ASSIGN THIS-OBJECT:LIVE = VALID-HANDLE(THIS-OBJECT:HANDLE).

        IF THIS-OBJECT:LIVE THEN
        DO:
            THIS-OBJECT:PARENT:ADD-CHILD(THIS-OBJECT).
        END.

        RETURN THIS-OBJECT:LIVE.
    END METHOD.
END CLASS.