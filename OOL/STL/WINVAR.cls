USING OOL.*.
USING OOL.STL.*.
CLASS OOL.STL.WINVAR ABSTRACT:
    DEFINE PROTECTED VARIABLE c_BoolDef AS CHARACTER.
    DEFINE PRIVATE   VARIABLE d_date    AS DATE.
    DEFINE PRIVATE   VARIABLE i_int     AS INTEGER.

    CONSTRUCTOR WINVAR ():
        ASSIGN c_BoolDef = "FALSE,TRUE,YES,NO,0,1".
    END CONSTRUCTOR.

    DESTRUCTOR WINVAR ():
    END DESTRUCTOR.

    METHOD PUBLIC LOGICAL NaN (INPUT cip_string AS CHARACTER):
        ASSIGN i_int = 0
               i_int = INTEGER(cip_string) NO-ERROR.

        RETURN ERROR-STATUS:ERROR.
    END METHOD.

    METHOD PUBLIC LOGICAL NaL (INPUT cip_string AS CHARACTER):
        RETURN LOOKUP(cip_string, c_BoolDef) = 0.
    END METHOD.

    METHOD PUBLIC LOGICAL NaDc (INPUT cip_string AS CHARACTER):
        IF INDEX(cip_string, ".") = 0 THEN RETURN FALSE.

        IF THIS-OBJECT:NaN(ENTRY(1,cip_string,".")) THEN RETURN FALSE.

        IF THIS-OBJECT:NaN(ENTRY(2,cip_string,".")) THEN RETURN FALSE.

        RETURN TRUE.
    END METHOD.

    METHOD PUBLIC LOGICAL NaDt (INPUT cip_string AS CHARACTER):
        ASSIGN d_date = ?
               d_date = DATE(cip_string) NO-ERROR.
        
        RETURN ERROR-STATUS:ERROR.
    END METHOD.

    METHOD PROTECTED CHARACTER CAST_STRING (INPUT iip_int AS INTEGER):
        RETURN STRING(iip_int).
    END METHOD.

    METHOD PROTECTED CHARACTER CAST_STRING (INPUT dip_dec AS DECIMAL):
        RETURN STRING(dip_dec).
    END METHOD.

    METHOD PROTECTED CHARACTER CAST_STRING (INPUT dip_dte AS DATE):
        RETURN STRING(dip_dte).
    END METHOD.

    METHOD PROTECTED CHARACTER CAST_STRING (INPUT lip_log AS LOGICAL):
        RETURN STRING(lip_log).
    END METHOD.

    METHOD PROTECTED CHARACTER CAST_STRING (INPUT hip_hnd AS HANDLE):
        RETURN STRING(hip_hnd).
    END METHOD.

    METHOD PUBLIC ABSTRACT CHARACTER ToStr ().

    METHOD PUBLIC ABSTRACT INTEGER ToInt ().

    METHOD PUBLIC ABSTRACT DECIMAL ToDec ().

    METHOD PUBLIC ABSTRACT LOGICAL ToLog ().

    METHOD PUBLIC ABSTRACT DATE ToDate ().

    METHOD PUBLIC ABSTRACT HANDLE ToHandle ().
END CLASS.